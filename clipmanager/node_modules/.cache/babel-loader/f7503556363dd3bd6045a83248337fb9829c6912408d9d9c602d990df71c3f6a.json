{"ast":null,"code":"import { collection, addDoc, updateDoc, deleteDoc, doc, query, where, onSnapshot, serverTimestamp } from 'firebase/firestore';\nimport { db } from '../firebaseConfig';\nconst COLLECTION_NAME = 'clips';\nexport const subscribeToClips = (userId, callback) => {\n  const q = query(collection(db, COLLECTION_NAME), where('userId', '==', userId));\n  return onSnapshot(q, snapshot => {\n    const clips = [];\n    snapshot.forEach(doc => {\n      var _data$createdAt, _data$updatedAt;\n      const data = doc.data();\n      clips.push({\n        id: doc.id,\n        ...data,\n        createdAt: (_data$createdAt = data.createdAt) !== null && _data$createdAt !== void 0 && _data$createdAt.toDate ? data.createdAt.toDate().toISOString() : new Date().toISOString(),\n        updatedAt: (_data$updatedAt = data.updatedAt) !== null && _data$updatedAt !== void 0 && _data$updatedAt.toDate ? data.updatedAt.toDate().toISOString() : new Date().toISOString()\n      });\n    });\n\n    // Sort in memory instead of using Firestore orderBy\n    clips.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));\n    callback(clips);\n  }, error => {\n    console.error('Error fetching clips:', error);\n    if (error.code === 'permission-denied') {\n      alert('Permission denied. Please check Firestore security rules.');\n    }\n  });\n};\nexport const addClip = async (userId, clipData) => {\n  try {\n    const docRef = await addDoc(collection(db, COLLECTION_NAME), {\n      ...clipData,\n      userId,\n      createdAt: serverTimestamp(),\n      updatedAt: serverTimestamp()\n    });\n    return docRef.id;\n  } catch (error) {\n    console.error('Error adding clip:', error);\n    throw error;\n  }\n};\nexport const updateClip = async (clipId, clipData) => {\n  try {\n    const clipRef = doc(db, COLLECTION_NAME, clipId);\n    await updateDoc(clipRef, {\n      ...clipData,\n      updatedAt: serverTimestamp()\n    });\n  } catch (error) {\n    console.error('Error updating clip:', error);\n    throw error;\n  }\n};\nexport const deleteClip = async clipId => {\n  try {\n    const clipRef = doc(db, COLLECTION_NAME, clipId);\n    await deleteDoc(clipRef);\n  } catch (error) {\n    console.error('Error deleting clip:', error);\n    throw error;\n  }\n};","map":{"version":3,"names":["collection","addDoc","updateDoc","deleteDoc","doc","query","where","onSnapshot","serverTimestamp","db","COLLECTION_NAME","subscribeToClips","userId","callback","q","snapshot","clips","forEach","_data$createdAt","_data$updatedAt","data","push","id","createdAt","toDate","toISOString","Date","updatedAt","sort","a","b","error","console","code","alert","addClip","clipData","docRef","updateClip","clipId","clipRef","deleteClip"],"sources":["/Users/louisc/Downloads/firebase-complete 2/src/services/clipboardService.js"],"sourcesContent":["import {\n  collection,\n  addDoc,\n  updateDoc,\n  deleteDoc,\n  doc,\n  query,\n  where,\n  onSnapshot,\n  serverTimestamp\n} from 'firebase/firestore';\nimport { db } from '../firebaseConfig';\n\nconst COLLECTION_NAME = 'clips';\n\nexport const subscribeToClips = (userId, callback) => {\n  const q = query(\n    collection(db, COLLECTION_NAME),\n    where('userId', '==', userId)\n  );\n\n  return onSnapshot(q, (snapshot) => {\n    const clips = [];\n    snapshot.forEach((doc) => {\n      const data = doc.data();\n      clips.push({\n        id: doc.id,\n        ...data,\n        createdAt: data.createdAt?.toDate ? data.createdAt.toDate().toISOString() : new Date().toISOString(),\n        updatedAt: data.updatedAt?.toDate ? data.updatedAt.toDate().toISOString() : new Date().toISOString()\n      });\n    });\n    \n    // Sort in memory instead of using Firestore orderBy\n    clips.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));\n    \n    callback(clips);\n  }, (error) => {\n    console.error('Error fetching clips:', error);\n    if (error.code === 'permission-denied') {\n      alert('Permission denied. Please check Firestore security rules.');\n    }\n  });\n};\n\nexport const addClip = async (userId, clipData) => {\n  try {\n    const docRef = await addDoc(collection(db, COLLECTION_NAME), {\n      ...clipData,\n      userId,\n      createdAt: serverTimestamp(),\n      updatedAt: serverTimestamp()\n    });\n    return docRef.id;\n  } catch (error) {\n    console.error('Error adding clip:', error);\n    throw error;\n  }\n};\n\nexport const updateClip = async (clipId, clipData) => {\n  try {\n    const clipRef = doc(db, COLLECTION_NAME, clipId);\n    await updateDoc(clipRef, {\n      ...clipData,\n      updatedAt: serverTimestamp()\n    });\n  } catch (error) {\n    console.error('Error updating clip:', error);\n    throw error;\n  }\n};\n\nexport const deleteClip = async (clipId) => {\n  try {\n    const clipRef = doc(db, COLLECTION_NAME, clipId);\n    await deleteDoc(clipRef);\n  } catch (error) {\n    console.error('Error deleting clip:', error);\n    throw error;\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}